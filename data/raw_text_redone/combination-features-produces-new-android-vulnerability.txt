combination of features produces new android vulnerability 
 a new vulnerability affecting android mobile devices results not from a traditional bug, but from the malicious combination of two legitimate permissions that power desirable and commonly-used features in popular apps. 
 cybersecurity researchers have identified a new vulnerability affecting android mobile devices that results not from a traditional bug, but from the malicious combination of two legitimate permissions that power desirable and commonly-used features in popular apps. (credit: maxwell guberman, georgia tech) 
 may 22, 2017 
 — atlanta, ga 
 a new vulnerability affecting android mobile devices results not from a traditional bug, but from the malicious combination of two legitimate permissions that power desirable and commonly-used features in popular apps. the combination could result in a new class of attacks, which has been dubbed “cloak and dagger.” 
 the vulnerability, which was identified and tested in closed environments by computer scientists at the georgia institute of technology, would allow attackers to silently take control of a mobile device, overlaying the graphical interface with false information to hide malicious activities being performed underneath – such as capturing passwords or extracting the user’s contacts. a successful attack would require the user to first install a type of malware that could be hidden in a pirated game or other app. 
 georgia tech researchers have disclosed the potential attack to google, maker of the android system, and details of the vulnerability will be presented may 24 at the 38th ieee symposium on security and privacy in san jose, california. but because it involves two common features that can be misused even when they behave as intended, the issue could be more difficult to resolve than ordinary operating system bugs. 
 “in cloak and dagger, we identified two different android features that when combined, allow an attacker to read, change or capture the data entered into popular mobile apps,” said 
 wenke lee , a professor in georgia tech’s 
 school of computer science 
 and co-director of the 
 institute for information security & privacy . “the two features involved are very useful in mapping, chat or password manager apps, so preventing their misuse will require users to trade convenience for security. this is as dangerous an attack as we could possibly describe.” 
 the research was sponsored by the national science foundation (nsf), office of naval research (onr) and the defense advanced research projects agency (darpa). 
 the first permission feature involved in the attack, known as “bind_accessibility_service,” supports the use of devices by disabled persons, allowing inputs such as user name and password to be made by voice command, and allowing outputs such as a screen reader to help the disabled view content. the second permission, known as “system_alert_window,” is an overlay or “draw on top” feature that produces a window on top of the device’s usual screen to display bubbles for a chat program or maps for a ride-sharing app. 
 when combined in a malicious way, “system_alert_window” acts as a cloak, while “bind_accessibility_service” serves as the dagger. the two could allow attackers to draw a window that fools users into believing they are interacting with legitimate features of the app. the malicious program, operating as the overlay, would then capture the user’s credentials for the malware author, while the accessibility permission would enter the credentials into the real app hidden beneath, allowing it to operate as expected, leaving the user with no clue that anything is awry. 
 the researchers tested a simulated attack on 20 users of android mobile devices and found that none of them noticed the attack. 
 of most concern to georgia tech’s researchers is that these permissions may be automatically included in legitimate apps from the google play store, meaning users do not need to explicitly grant permissions for the attack to succeed. 
 “this is a design flaw that some might say allows the app functionality to work as intended, but our research shows that it can be misused,” said yanick fratantonio, the paper’s first author and a georgia tech ph.d. summer intern from the university of california santa barbara. “once the phone is compromised, there may be no way for the user to understand what has happened.” 
 nearly 10 percent of the top 5,000 android apps use the overlay feature, noted fratantonio, and many are downloaded with the accessibility feature enabled. 
 while both permissions have been used separately as user-interface redressing attacks and “a11y attacks,” previous research did not examine what happens when they are combined, noted simon p. chung, a research scientist at georgia tech’s school of computer science and one of the study’s co-authors. 
 creating vulnerabilities when permissions are combined may be a reality that system developers will have to consider more seriously in the future, fratantonio said. “changing a feature is not like fixing a bug,” he explained. “system designers will now have to think more about how seemingly unrelated features could interact. features do not operate separately on the device.” 
 android versions up to and including the current 7.1.2 are vulnerable to this attack. the researchers caution that it may be difficult to determine the status of the settings required for the attack. 
 there are two key precautions, lee and fratantonio agree. one is to avoid downloading apps from providers other than branded outlets such as the google play store. a second step is to check the permission requests that apps make before allowing them to operate. 
 “users need to be careful about the permissions that new apps request,” said lee. “if there are very broad permissions, or the permissions don’t seem to match what the app is promising to do, you need to be sure you really need that app.” 
 the researchers have produced a video that shows the attack and how to check these permissions, which are in different locations depending on the mobile operating system version. 
 “apps from name-brand sources such as facebook, uber and skype should be okay,” said lee. “but with a random game or free versions of paid apps that you might download, you should be very careful. these features are very powerful and can be abused to do anything you could do as a user – without you knowing.” 
 in addition to the researchers already mentioned, the project also included chenxiong qian from georgia tech. 
 this research was supported by the nsf awards cns-1017265, cns-0831300, cns-1149051 and dge-1500084, by the onr under grants n000140911042 and n000141512162, and by the darpa transparent computing program under contract darpa-15-15-tc-fp-006. any opinions, findings, conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the nsf, onr or darpa. 
 citation : yanick fratantonio, et al., “cloak and dagger: from two permissions to complete control of the ui feedback loop,” (38th ieee symposium on security and privacy, 2017). 
 research news 
 georgia institute of technology 
 177 north avenue 
 atlanta, georgia  30332-0181  usa 
 media relations contacts : john toon (404-894-6986) (jtoon@gatech.edu) or josh brown (404-385-0500) (josh.brown@comm.gatech.edu) 
 writer : john toon 
 additional images 
 contact 
 john toon 
 research news 
 (404) 894-6986 
 email 
 jtoon@gatech.edu 
 georgia institute of technology 
 north avenue atlanta, ga 30332 
 +1 404.894.2000